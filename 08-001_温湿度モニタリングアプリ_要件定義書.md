### 文書番号: 08-001

## 1. アプリ名
- アプリ名: 温湿度モニタリングアプリ

## 2. 概要
DHT11センサーを用いて温度・湿度を定期的に取得し、コンソール表示を行うPythonスクリプトです。初心者がセンサー読み取りの基礎を学べるよう、シンプルな構成で提供します。

## 3. 目的
- DHTセンサーからのデータ取得方法を習得する
- PythonによるI/O制御とデータ処理技術を学ぶ

## 4. 対象利用者
- プログラミング初心者
- Raspberry Pi入門者
- センサー制御を学びたい電子工作学習者

## 5. システム構成
| コンポーネント       | 役割                             |
|----------------------|----------------------------------|
| Raspberry Pi 5       | センサー制御、スクリプト実行     |
| DHT11センサー       | 温度・湿度測定                   |
| ジャンパーワイヤ     | センサーとGPIOピンの接続         |
| microSDカード        | OSおよびデータ保存              |

## 6. ハードウェア要件
- Raspberry Pi 5本体
- microSDカード（Raspberry Pi OSインストール済み）
- DHT11センサー
- ジャンパーワイヤ（オス–オス）
- 抵抗（4.7kΩプルアップ、センサーによる）
- 電源（公式5V電源アダプタ）

## 7. ソフトウェア要件
- OS：Raspberry Pi OS Bookworm以降
- 言語：Python 3.9以上
- 仮想環境：venv（Bookworm以降で必須）
- ライブラリ：
  - adafruit-blinka（CircuitPython互換レイヤー）
  - adafruit-circuitpython-dht（DHT11/DHT22センサー制御）
  - lgpio（Raspberry Pi 5 GPIO制御）
  - time（標準）
  - sys（標準）

### 7.1 Raspberry Pi 5でのライブラリ制約

Raspberry Pi 5では新しいGPIOチップ（RP1）が採用されており、従来のライブラリに以下の制約があります：

| ライブラリ | Raspberry Pi 5対応 | 備考 |
|-----------|-------------------|------|
| Adafruit_DHT | × | 非対応（Unknown platformエラー） |
| RPi.GPIO | × | 非対応 |
| pigpio | × | Bookwormで廃止 |
| adafruit-circuitpython-dht | ○ | 推奨（本プロジェクトで使用） |
| lgpio | ○ | Raspberry Pi 5標準 |

**注意**: `adafruit-circuitpython-dht`は名前に「CircuitPython」とありますが、`adafruit-blinka`が互換レイヤーを提供するため、Raspberry Pi上の通常のPython（CPython）で使用できます。

## 8. 機能要件
1. **スクリプト構成**
   - `dht11_basic.py`: センサー値を2秒間隔で読み取り、コンソールに温度・湿度を表示する
2. **GPIO初期化**
   - DHT11センサーが接続されたGPIOピン（GPIO4）を読み取りに利用する
3. **データ取得**
   - センサーから温度（℃）と湿度（％）を取得し、読み取りエラー時は再試行まで待機する
4. **表示**
   - 取得したデータをコンソールに出力し、華氏換算値も表示する
5. **測定間隔**
   - 固定2秒で測定する
6. **例外処理**
   - センサー読み取り時の`RuntimeError`を捕捉し、ユーザーにエラーメッセージを通知する
7. **クリーンアップ**
   - プログラム終了時にセンサーリソースを確実に解放する

## 9. 非機能要件
- **可読性**: PEP8準拠、適切なコメントを記載
- **保守性**: 関数分割により主要処理を明確化
- **構成整理**: シンプルな1ファイル構成
- **耐久性**: 長時間実行時にメモリリークなし

## 10. テスト要件
- **センサーテスト**: DHT11で正常に測定できる
- **間隔テスト**: 規定の測定間隔（2秒）が守られる
- **異常系テスト**: センサー未接続/読み取り失敗時の動作確認
- **終了テスト**: Ctrl+Cで正常に終了し、リソースが解放される

## 11. 受け入れ基準
1. 2秒間隔の測定結果が正しく取得・表示される
2. エラー発生時に適切なメッセージが表示される
3. 長時間実行後も安定して動作する
4. Ctrl+Cで正常に終了し、センサーがクリーンアップされる

---
以上の要件をもとに、温湿度モニタリングアプリのプロトタイプを開発してください。
